import React, { useState, useEffect, useRef } from 'react';
import botAssistant from './t00_botAssistant.module.css';

const BotAssistant = () => {
  const [messages, setMessages] = useState([]);
  const [inputText, setInputText] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [isExpanded, setIsExpanded] = useState(false);
  const messagesEndRef = useRef(null);

  // Base de conhecimento do bot - HARMONIC GROUP (COMPLETA COM TODAS AS VARIA√á√ïES)
const botKnowledge = {
  // =============================================
  // SAUDA√á√ïES B√ÅSICAS
  // =============================================
  'ol√°': 'Ol√°! Bem-vindo √† Harmonic Group! Como posso ajudar voc√™ com nossos servi√ßos musicais para eventos?',
  'ola': 'Ol√°! Bem-vindo √† Harmonic Group! Como posso ajudar voc√™ com nossos servi√ßos musicais para eventos?',
  'oi': 'Oi! Sou o assistente virtual da Harmonic Group. Em que posso ajudar?',
  'bom dia': 'Bom dia! üåû Em que posso ajudar com os servi√ßos musicais da Harmonic Group?',
  'boa tarde': 'Boa tarde! ‚òÄÔ∏è Como posso auxiliar voc√™ hoje?',
  'boa noite': 'Boa noite! üåô Estou aqui para ajudar com nossos servi√ßos musicais.',

  // =============================================
  // SOBRE OS SERVI√áOS E A EMPRESA
  // =============================================
  'harmonic group': 'A Harmonic Group √© especializada em servi√ßos musicais para eventos! Oferecemos contrata√ß√£o de m√∫sicos e bandas para casamentos, formaturas, festas infantis, eventos corporativos e muito mais! üéµ',
  'empresa': 'A Harmonic Group √© especializada em servi√ßos musicais para eventos! Oferecemos contrata√ß√£o de m√∫sicos profissionais para diversos tipos de celebra√ß√µes.',
  
  'servi√ßos': 'Oferecemos servi√ßos musicais completos para: casamentos, bodas, festas privadas, debutantes, formaturas, festas infantis e eventos corporativos. Qual tipo de evento voc√™ est√° planejando?',
  'servicos': 'Oferecemos servi√ßos musicais completos para: casamentos, bodas, festas privadas, debutantes, formaturas, festas infantis e eventos corporativos. Qual tipo de evento voc√™ est√° planejando?',
  'o que oferecem': 'Oferecemos servi√ßos musicais completos para: casamentos, bodas, festas privadas, debutantes, formaturas, festas infantis e eventos corporativos.',
  
  'tipos de evento': 'Atendemos casamentos, bodas, jantares privados, festas de debutantes, formaturas, festas infantis e eventos corporativos! Para qual evento voc√™ precisa de m√∫sica?',
  'eventos': 'Atendemos casamentos, bodas, jantares privados, festas de debutantes, formaturas, festas infantis e eventos corporativos! Para qual evento voc√™ precisa de m√∫sica?',
  'quais eventos': 'Atendemos casamentos, bodas, jantares privados, festas de debutantes, formaturas, festas infantis e eventos corporativos! Para qual evento voc√™ precisa de m√∫sica?',
  'quais eventos atendem': 'Atendemos casamentos, bodas, jantares privados, festas de debutantes, formaturas, festas infantis e eventos corporativos! Para qual evento voc√™ precisa de m√∫sica?',
  'que eventos': 'Atendemos casamentos, bodas, jantares privados, festas de debutantes, formaturas, festas infantis e eventos corporativos! Para qual evento voc√™ precisa de m√∫sica?',
  'atendem quais eventos': 'Atendemos casamentos, bodas, jantares privados, festas de debutantes, formaturas, festas infantis e eventos corporativos! Para qual evento voc√™ precisa de m√∫sica?',
  
  'm√∫sicos': 'Todos nossos m√∫sicos s√£o profissionais experientes e selecionados! Eles t√™m vasta experi√™ncia em performances ao vivo para garantir qualidade no seu evento.',
  'musicos': 'Todos nossos m√∫sicos s√£o profissionais experientes e selecionados! Eles t√™m vasta experi√™ncia em performances ao vivo para garantir qualidade no seu evento.',
  'profissionais': 'Todos nossos m√∫sicos s√£o profissionais experientes e selecionados! Eles t√™m vasta experi√™ncia em performances ao vivo para garantir qualidade no seu evento.',
  'experi√™ncia': 'Todos nossos m√∫sicos s√£o profissionais experientes e selecionados! Eles t√™m vasta experi√™ncia em performances ao vivo para garantir qualidade no seu evento.',
  'experiencia': 'Todos nossos m√∫sicos s√£o profissionais experientes e selecionados! Eles t√™m vasta experi√™ncia em performances ao vivo para garantir qualidade no seu evento.',
  
  'bandas': 'Temos diversas bandas e forma√ß√µes musicais! Voc√™ pode escolher por estilo musical na nossa plataforma.',
  'banda': 'Temos diversas bandas e forma√ß√µes musicais! Voc√™ pode escolher por estilo musical na nossa plataforma.',

  // =============================================
  // PROCESSO DE CONTRATA√á√ÉO E AGENDAMENTO
  // =============================================
  'contratar': 'Para contratar, acesse nossa plataforma online! L√° voc√™ pode ver m√∫sicos dispon√≠veis, ver agendas e solicitar or√ßamento. Posso ajudar com alguma d√∫vida espec√≠fica?',
  'contrata√ß√£o': 'Para contratar, acesse nossa plataforma online! L√° voc√™ pode ver m√∫sicos dispon√≠veis, ver agendas e solicitar or√ßamento. Posso ajudar com alguma d√∫vida espec√≠fica?',
  'contratacao': 'Para contratar, acesse nossa plataforma online! L√° voc√™ pode ver m√∫sicos dispon√≠veis, ver agendas e solicitar or√ßamento. Posso ajudar com alguma d√∫vida espec√≠fica?',
  'como contratar': 'Para contratar, acesse nossa plataforma online! L√° voc√™ pode ver m√∫sicos dispon√≠veis, ver agendas e solicitar or√ßamento.',
  'quero contratar': 'Para contratar, acesse nossa plataforma online! L√° voc√™ pode ver m√∫sicos dispon√≠veis, ver agendas e solicitar or√ßamento.',
  
  'agendar': 'O agendamento √© feito pela nossa plataforma em tempo real! Ap√≥s escolher o m√∫sico e data, a confirma√ß√£o √© instant√¢nea com notifica√ß√£o por WhatsApp ou e-mail.',
  'agendamento': 'O agendamento √© feito pela nossa plataforma em tempo real! Ap√≥s escolher o m√∫sico e data, a confirma√ß√£o √© instant√¢nea com notifica√ß√£o por WhatsApp ou e-mail.',
  'marcar': 'O agendamento √© feito pela nossa plataforma em tempo real! Ap√≥s escolher o m√∫sico e data, a confirma√ß√£o √© instant√¢nea com notifica√ß√£o por WhatsApp ou e-mail.',
  'reservar': 'O agendamento √© feito pela nossa plataforma em tempo real! Ap√≥s escolher o m√∫sico e data, a confirma√ß√£o √© instant√¢nea com notifica√ß√£o por WhatsApp ou e-mail.',
  
  'repert√≥rio': 'Sim! Voc√™ pode escolher o repert√≥rio! Nossa plataforma tem lista de m√∫sicas sugeridas e aceita pedidos espec√≠ficos para personalizar sua experi√™ncia.',
  'repertorio': 'Sim! Voc√™ pode escolher o repert√≥rio! Nossa plataforma tem lista de m√∫sicas sugeridas e aceita pedidos espec√≠ficos para personalizar sua experi√™ncia.',
  'm√∫sicas': 'Sim! Voc√™ pode escolher o repert√≥rio! Nossa plataforma tem lista de m√∫sicas sugeridas e aceita pedidos espec√≠ficos para personalizar sua experi√™ncia.',
  'musicas': 'Sim! Voc√™ pode escolher o repert√≥rio! Nossa plataforma tem lista de m√∫sicas sugeridas e aceita pedidos espec√≠ficos para personalizar sua experi√™ncia.',
  'escolher m√∫sica': 'Sim! Voc√™ pode escolher o repert√≥rio! Nossa plataforma tem lista de m√∫sicas sugeridas e aceita pedidos espec√≠ficos para personalizar sua experi√™ncia.',
  'escolher musicas': 'Sim! Voc√™ pode escolher o repert√≥rio! Nossa plataforma tem lista de m√∫sicas sugeridas e aceita pedidos espec√≠ficos para personalizar sua experi√™ncia.',
  
  'imprevisto': 'Em caso de imprevisto com o m√∫sico, nosso sistema busca automaticamente um substituto qualificado para n√£o afetar seu evento!',
  'problema': 'Em caso de imprevisto com o m√∫sico, nosso sistema busca automaticamente um substituto qualificado para n√£o afetar seu evento!',
  'substituto': 'Em caso de imprevisto com o m√∫sico, nosso sistema busca automaticamente um substituto qualificado para n√£o afetar seu evento!',

  // =============================================
  // CONTRATOS, PAGAMENTOS E SEGURAN√áA
  // =============================================
  'contrato': 'Sim! Geramos contrato automatizado em PDF com todas as cl√°usulas, valores e combina√ß√µes. Tem validade jur√≠dica e garante seguran√ßa para ambas as partes.',
  'contratos': 'Sim! Geramos contrato automatizado em PDF com todas as cl√°usulas, valores e combina√ß√µes. Tem validade jur√≠dica e garante seguran√ßa para ambas as partes.',
  'documento': 'Sim! Geramos contrato automatizado em PDF com todas as cl√°usulas, valores e combina√ß√µes. Tem validade jur√≠dica e garante seguran√ßa para ambas as partes.',
  'legal': 'Sim! Geramos contrato automatizado em PDF com todas as cl√°usulas, valores e combina√ß√µes. Tem validade jur√≠dica e garante seguran√ßa para ambas as partes.',
  
  'pagamento': 'Aceitamos cart√£o de cr√©dito (at√© 12x), d√©bito online e PIX! Todos os valores s√£o transparentes, sem taxas escondidas.',
  'pagamentos': 'Aceitamos cart√£o de cr√©dito (at√© 12x), d√©bito online e PIX! Todos os valores s√£o transparentes, sem taxas escondidas.',
  'pagar': 'Aceitamos cart√£o de cr√©dito (at√© 12x), d√©bito online e PIX! Todos os valores s√£o transparentes, sem taxas escondidas.',
  'forma de pagamento': 'Aceitamos cart√£o de cr√©dito (at√© 12x), d√©bito online e PIX! Todos os valores s√£o transparentes, sem taxas escondidas.',
  'formas de pagamento': 'Aceitamos cart√£o de cr√©dito (at√© 12x), d√©bito online e PIX! Todos os valores s√£o transparentes, sem taxas escondidas.',
  
  'pre√ßo': 'Temos pacotes adaptados para cada tipo de evento! Os valores variam conforme o servi√ßo. Que tipo de evento voc√™ est√° planejando?',
  'preco': 'Temos pacotes adaptados para cada tipo de evento! Os valores variam conforme o servi√ßo. Que tipo de evento voc√™ est√° planejando?',
  'valor': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda.',
  'valores': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda.',
  'quanto custa': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda.',
  'custo': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda.',
  
  'seguran√ßa': 'Nossa plataforma usa criptografia para proteger seus dados! Seus dados pessoais e de pagamento est√£o sempre seguros.',
  'seguranca': 'Nossa plataforma usa criptografia para proteger seus dados! Seus dados pessoais e de pagamento est√£o sempre seguros.',
  'prote√ß√£o': 'Nossa plataforma usa criptografia para proteger seus dados! Seus dados pessoais e de pagamento est√£o sempre seguros.',
  'protecao': 'Nossa plataforma usa criptografia para proteger seus dados! Seus dados pessoais e de pagamento est√£o sempre seguros.',
  'dados': 'Nossa plataforma usa criptografia para proteger seus dados! Seus dados pessoais e de pagamento est√£o sempre seguros.',
  'or√ßamento': 'Os or√ßamentos s√£o personalizados conforme o tipo de evento, n√∫mero de m√∫sicos e dura√ß√£o do servi√ßo. Posso ajudar a conectar voc√™ com nosso time para um or√ßamento detalhado! Que tipo de evento voc√™ est√° planejando?',
'orcamento': 'Os or√ßamentos s√£o personalizados conforme o tipo de evento, n√∫mero de m√∫sicos e dura√ß√£o do servi√ßo. Posso ajudar a conectar voc√™ com nosso time para um or√ßamento detalhado! Que tipo de evento voc√™ est√° planejando?',
'orcamento': 'Os or√ßamentos s√£o personalizados conforme o tipo de evento, n√∫mero de m√∫sicos e dura√ß√£o do servi√ßo. Posso ajudar a conectar voc√™ com nosso time para um or√ßamento detalhado! Que tipo de evento voc√™ est√° planejando?',
'quanto √©': 'Os valores variam conforme o pacote escolhido! Temos op√ß√µes para diferentes or√ßamentos. Pode me dizer para qual tipo de evento voc√™ precisa?',
'quanto custa': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda. Para qual evento voc√™ gostaria de saber?',
'valor': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda. Para qual evento voc√™ gostaria de saber?',
'pre√ßo': 'Temos pacotes adaptados para cada tipo de evento! Os valores variam conforme o servi√ßo. Que tipo de evento voc√™ est√° planejando?',
'preco': 'Temos pacotes adaptados para cada tipo de evento! Os valores variam conforme o servi√ßo. Que tipo de evento voc√™ est√° planejando?',
'quero or√ßamento': 'Excelente! Para gerar um or√ßamento preciso, preciso saber: qual o tipo de evento e a data aproximada?',
'solicitar or√ßamento': 'Perfeito! Acesse nossa plataforma ou me informe o tipo de evento que deseja para ajudar com o or√ßamento!',
'fazer or√ßamento': '√ìtimo! Posso ajudar a direcionar para o or√ßamento ideal. √â para casamento, formatura, evento corporativo?',

'contrato': 'Sim! Geramos contrato automatizado em PDF com todas as cl√°usulas, valores e combina√ß√µes. Tem validade jur√≠dica e garante seguran√ßa para ambas as partes.',
'contratos': 'Sim! Geramos contrato automatizado em PDF com todas as cl√°usulas, valores e combina√ß√µes. Tem validade jur√≠dica e garante seguran√ßa para ambas as partes.',

// OR√áAMENTOS E PRE√áOS - NOVAS ENTRADAS
'or√ßamento': 'Os or√ßamentos s√£o personalizados conforme o tipo de evento, n√∫mero de m√∫sicos e dura√ß√£o do servi√ßo. Posso ajudar a conectar voc√™ com nosso time para um or√ßamento detalhado! Que tipo de evento voc√™ est√° planejando?',
'orcamento': 'Os or√ßamentos s√£o personalizados conforme o tipo de evento, n√∫mero de m√∫sicos e dura√ß√£o do servi√ßo. Posso ajudar a conectar voc√™ com nosso time para um or√ßamento detalhado! Que tipo de evento voc√™ est√° planejando?',
'quanto √©': 'Os valores variam conforme o pacote escolhido! Temos op√ß√µes para diferentes or√ßamentos. Pode me dizer para qual tipo de evento voc√™ precisa?',
'quanto custa': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda. Para qual evento voc√™ gostaria de saber?',
'quanto fica': 'O valor depende do tipo de evento e forma√ß√£o musical! Temos op√ß√µes a partir de R$ X. Para qual ocasi√£o voc√™ precisa?',
'valor': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda.',
'valores': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda.',
'pre√ßo': 'Temos pacotes adaptados para cada tipo de evento! Os valores variam conforme o servi√ßo. Que tipo de evento voc√™ est√° planejando?',
'preco': 'Temos pacotes adaptados para cada tipo de evento! Os valores variam conforme o servi√ßo. Que tipo de evento voc√™ est√° planejando?',
'pre√ßos': 'Temos pacotes adaptados para cada tipo de evento! Os valores variam conforme o servi√ßo. Que tipo de evento voc√™ est√° planejando?',
'precos': 'Temos pacotes adaptados para cada tipo de evento! Os valores variam conforme o servi√ßo. Que tipo de evento voc√™ est√° planejando?',
'quero or√ßamento': 'Excelente! Para gerar um or√ßamento preciso, preciso saber: qual o tipo de evento e a data aproximada?',
'solicitar or√ßamento': 'Perfeito! Acesse nossa plataforma ou me informe o tipo de evento que deseja para ajudar com o or√ßamento!',
'fazer or√ßamento': '√ìtimo! Posso ajudar a direcionar para o or√ßamento ideal. √â para casamento, formatura, evento corporativo?',
'custo': 'Nossos pre√ßos s√£o personalizados por evento! Temos pacotes completos que podem incluir diferentes formata√ß√µes de banda.',

'pagamento': 'Aceitamos cart√£o de cr√©dito (at√© 12x), d√©bito online e PIX! Todos os valores s√£o transparentes, sem taxas escondidas.',
'pagamentos': 'Aceitamos cart√£o de cr√©dito (at√© 12x), d√©bito online e PIX! Todos os valores s√£o transparentes, sem taxas escondidas.',

'seguran√ßa': 'Nossa plataforma usa criptografia para proteger seus dados! Seus dados pessoais e de pagamento est√£o sempre seguros.',
'seguranca': 'Nossa plataforma usa criptografia para proteger seus dados! Seus dados pessoais e de pagamento est√£o sempre seguros.',



  // =============================================
  // PLATAFORMA E TECNOLOGIA
  // =============================================
  'aplicativo': 'N√£o precisa baixar nada! Nossa plataforma √© 100% online e funciona em qualquer navegador de celular, tablet ou computador.',
  'app': 'N√£o precisa baixar nada! Nossa plataforma √© 100% online e funciona em qualquer navegador de celular, tablet ou computador.',
  'download': 'N√£o precisa baixar nada! Nossa plataforma √© 100% online e funciona em qualquer navegador de celular, tablet ou computador.',
  
  'cadastrar': 'O cadastro √© r√°pido e gratuito! Acesse nosso site, clique em "Cadastrar" e em minutos voc√™ explora todos os servi√ßos.',
  'cadastro': 'O cadastro √© r√°pido e gratuito! Acesse nosso site, clique em "Cadastrar" e em minutos voc√™ explora todos os servi√ßos.',
  'registrar': 'O cadastro √© r√°pido e gratuito! Acesse nosso site, clique em "Cadastrar" e em minutos voc√™ explora todos os servi√ßos.',
  
  'notifica√ß√£o': 'Enviamos notifica√ß√µes por WhatsApp e e-mail sobre confirma√ß√µes, lembretes e mudan√ßas na agenda!',
  'notificacao': 'Enviamos notifica√ß√µes por WhatsApp e e-mail sobre confirma√ß√µes, lembretes e mudan√ßas na agenda!',
  'notifica√ß√µes': 'Enviamos notifica√ß√µes por WhatsApp e e-mail sobre confirma√ß√µes, lembretes e mudan√ßas na agenda!',
  'lembrete': 'Enviamos notifica√ß√µes por WhatsApp e e-mail sobre confirma√ß√µes, lembretes e mudan√ßas na agenda!',
  
  'chatbot': 'Esse sou eu! üòä Estou aqui para responder d√∫vidas 24/7 sobre servi√ßos, pre√ßos e funcionamento da plataforma.',

  // =============================================
  // PARA M√öSICOS E PARCEIROS
  // =============================================
  'trabalhar': 'Voc√™ √© m√∫sico? Candidate-se em "Trabalhe Conosco" ou "Seja um M√∫sico Parceiro" na nossa plataforma! Ap√≥s an√°lise, entramos em contato.',
  'trabalho': 'Voc√™ √© m√∫sico? Candidate-se em "Trabalhe Conosco" ou "Seja um M√∫sico Parceiro" na nossa plataforma! Ap√≥s an√°lise, entramos em contato.',
  'parceiro': 'Voc√™ √© m√∫sico? Candidate-se em "Trabalhe Conosco" ou "Seja um M√∫sico Parceiro" na nossa plataforma! Ap√≥s an√°lise, entramos em contato.',
  'm√∫sico parceiro': 'M√∫sicos parceiros t√™m √°rea personalizada para gerenciar agenda, repert√≥rio, disponibilidade e contratos!',
  'musico parceiro': 'M√∫sicos parceiros t√™m √°rea personalizada para gerenciar agenda, repert√≥rio, disponibilidade e contratos!',
  '√°rea do m√∫sico': 'M√∫sicos parceiros t√™m √°rea personalizada para gerenciar agenda, repert√≥rio, disponibilidade e contratos!',
  'area do musico': 'M√∫sicos parceiros t√™m √°rea personalizada para gerenciar agenda, repert√≥rio, disponibilidade e contratos!',

  // =============================================
  // PERSONALIZA√á√ÉO E EXPERI√äNCIA
  // =============================================
  'm√∫sica personalizada': 'Sim! Aceitamos pedidos de m√∫sicas espec√≠ficas! Durante a contrata√ß√£o, solicite e analisamos a viabilidade com o m√∫sico.',
  'musica personalizada': 'Sim! Aceitamos pedidos de m√∫sicas espec√≠ficas! Durante a contrata√ß√£o, solicite e analisamos a viabilidade com o m√∫sico.',
  'personalizar': 'Sim! Aceitamos pedidos de m√∫sicas espec√≠ficas! Durante a contrata√ß√£o, solicite e analisamos a viabilidade com o m√∫sico.',
  'pedido especial': 'Sim! Aceitamos pedidos de m√∫sicas espec√≠ficas! Durante a contrata√ß√£o, solicite e analisamos a viabilidade com o m√∫sico.',
  
  'pacotes': 'Temos pacotes completos como "Pacote Casamento" e "Pacote Formatura" com diferentes formata√ß√µes de banda e horas de servi√ßo!',
  'pacote': 'Temos pacotes completos como "Pacote Casamento" e "Pacote Formatura" com diferentes formata√ß√µes de banda e horas de servi√ßo!',
  'combo': 'Temos pacotes completos como "Pacote Casamento" e "Pacote Formatura" com diferentes formata√ß√µes de banda e horas de servi√ßo!',
  
  'estilo musical': 'Nossos m√∫sicos s√£o categorizados por estilo (Jazz, MPB, Sertanejo, Pop, Cl√°ssico)! Use os filtros na plataforma para encontrar o perfil ideal.',
  'estilo': 'Nossos m√∫sicos s√£o categorizados por estilo (Jazz, MPB, Sertanejo, Pop, Cl√°ssico)! Use os filtros na plataforma para encontrar o perfil ideal.',
  'g√™nero': 'Nossos m√∫sicos s√£o categorizados por estilo (Jazz, MPB, Sertanejo, Pop, Cl√°ssico)! Use os filtros na plataforma para encontrar o perfil ideal.',
  'genero': 'Nossos m√∫sicos s√£o categorizados por estilo (Jazz, MPB, Sertanejo, Pop, Cl√°ssico)! Use os filtros na plataforma para encontrar o perfil ideal.',
  
  'jazz': 'Temos excelentes m√∫sicos de Jazz! Perfeito para eventos sofisticados como jantares corporativos ou casamentos elegantes.',
  'mpb': 'MPB √© um de nossos estilos mais populares! Temos v√°rios artistas especializados.',
  'sertanejo': 'Sertanejo √© sucesso garantido! Temos duplas e bandas completas no estilo.',
  'pop': 'M√∫sica pop para animar qualquer festa! Temos bandas vers√°teis no repert√≥rio pop.',
  'cl√°ssico': 'M√∫sica cl√°ssica para cerim√¥nias elegantes! Temos solistas e grupos especializados.',
  'classico': 'M√∫sica cl√°ssica para cerim√¥nias elegantes! Temos solistas e grupos especializados.',

  // =============================================
  // SUPORTE E RESOLU√á√ÉO
  // =============================================
  'suporte': 'Nosso time humano est√° sempre dispon√≠vel! Pe√ßa para falar com um atendente pelo chat ou entre em contato via WhatsApp/e-mail.',
  'atendimento': 'Nosso time humano est√° sempre dispon√≠vel! Pe√ßa para falar com um atendente pelo chat ou entre em contato via WhatsApp/e-mail.',
  'ajuda humana': 'Nosso time humano est√° sempre dispon√≠vel! Pe√ßa para falar com um atendente pelo chat ou entre em contato via WhatsApp/e-mail.',
  
  'cancelar': 'Cancelamentos seguem as condi√ß√µes do contrato. Entre em contato conosco o quanto antes para avaliar as op√ß√µes.',
  'cancelamento': 'Cancelamentos seguem as condi√ß√µes do contrato. Entre em contato conosco o quanto antes para avaliar as op√ß√µes.',
  
  'remarcar': 'Remarca√ß√µes s√£o poss√≠veis! Consulte as condi√ß√µes no seu contrato ou fale com nosso atendimento.',
  'remarca√ß√£o': 'Remarca√ß√µes s√£o poss√≠veis! Consulte as condi√ß√µes no seu contrato ou fale com nosso atendimento.',
  'remarcacao': 'Remarca√ß√µes s√£o poss√≠veis! Consulte as condi√ß√µes no seu contrato ou fale com nosso atendimento.',
  'mudar data': 'Remarca√ß√µes s√£o poss√≠veis! Consulte as condi√ß√µes no seu contrato ou fale com nosso atendimento.',
  
  'avalia√ß√£o': 'Ap√≥s o evento, voc√™ recebe um e-mail para avaliar o servi√ßo! Seu feedback √© essencial para nossa qualidade.',
  'avaliacao': 'Ap√≥s o evento, voc√™ recebe um e-mail para avaliar o servi√ßo! Seu feedback √© essencial para nossa qualidade.',
  'feedback': 'Valorizamos seu feedback! Ap√≥s cada evento, enviamos pesquisa de satisfa√ß√£o.',
  'opini√£o': 'Valorizamos seu feedback! Ap√≥s cada evento, enviamos pesquisa de satisfa√ß√£o.',
  'opiniao': 'Valorizamos seu feedback! Ap√≥s cada evento, enviamos pesquisa de satisfa√ß√£o.',

  // =============================================
  // DIFERENCIAIS
  // =============================================
  'diferencial': 'Oferecemos servi√ßo padronizado e profissional com tecnologia! Temos transpar√™ncia, seguran√ßa jur√≠dica com contratos automatizados e gest√£o integrada em uma plataforma √∫nica!',
  'diferenciais': 'Oferecemos servi√ßo padronizado e profissional com tecnologia! Temos transpar√™ncia, seguran√ßa jur√≠dica com contratos automatizados e gest√£o integrada em uma plataforma √∫nica!',
  'vantagem': 'Diferente da informalidade do setor, temos processos padronizados, plataforma tecnol√≥gica e profissionais selecionados!',
  'vantagens': 'Diferente da informalidade do setor, temos processos padronizados, plataforma tecnol√≥gica e profissionais selecionados!',
  'por que escolher': 'Diferente da informalidade do setor, temos processos padronizados, plataforma tecnol√≥gica e profissionais selecionados!',

  // =============================================
  // DEFAULT
  // =============================================
  'default': 'Desculpe, n√£o entendi completamente. Sou especializado em servi√ßos da Harmonic Group como: contrata√ß√£o de m√∫sicos, agendamento para eventos, contratos e pagamentos. Pode reformular sua pergunta?'
};

  // Efeito para rolar para a √∫ltima mensagem
  useEffect(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  }, [messages]);

  // Fun√ß√£o para obter resposta do bot - MELHORADA
  const getBotResponse = (userMessage) => {
    const message = userMessage.toLowerCase();
    
    // Procura por correspond√™ncias exatas primeiro
    if (botKnowledge[message]) {
      return botKnowledge[message];
    }
    
    // Depois procura por palavras-chave na mensagem
    for (const [key, response] of Object.entries(botKnowledge)) {
      if (message.includes(key) && key !== 'default') {
        return response;
      }
    }
    
    return botKnowledge.default;
  };

  // Fun√ß√£o para enviar mensagem
  const sendMessage = (text) => {
    if (!text.trim()) return;

    // Mensagem do usu√°rio
    const userMessage = {
      id: 'user-' + Date.now(),
      type: 'user',
      text: text,
      timestamp: new Date()
    };

    setMessages(prev => [...prev, userMessage]);
    setInputText('');
    setIsLoading(true);

    // Simular processamento do bot
    setTimeout(() => {
      const botResponse = getBotResponse(text);
      
      const botMessage = {
        id: 'bot-' + Date.now(),
        type: 'bot',
        text: botResponse,
        timestamp: new Date()
      };

      setMessages(prev => [...prev, botMessage]);
      setIsLoading(false);
    }, 1000);
  };

  // Enviar com Enter
  const handleKeyPress = (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSend();
    }
  };

  // Enviar mensagem
  const handleSend = () => {
    if (inputText.trim()) {
      sendMessage(inputText);
    }
  };

  // Alternar entre expandido e minimizado
  const toggleExpand = () => {
    setIsExpanded(!isExpanded);
  };

  // Mensagem de boas-vindas quando expandir pela primeira vez
  useEffect(() => {
    if (isExpanded && messages.length === 0) {
      setTimeout(() => {
        setMessages([{
          id: 'welcome',
          type: 'bot',
          text: 'üéµ Ol√°! Sou o assistente virtual da Harmonic Group! Posso ajudar com informa√ß√µes sobre servi√ßos musicais, contrata√ß√£o de m√∫sicos, agendamento para eventos e muito mais. Como posso ajudar voc√™ hoje?',
          timestamp: new Date()
        }]);
      }, 500);
    }
  }, [isExpanded]);

  // Sugest√µes de perguntas
  const quickQuestions = [
    'Quais eventos atendem?',
    'Como contratar um m√∫sico?',
    'Posso escolher as m√∫sicas?',
    'Quais formas de pagamento?'
  ];

  // Bot√£o flutuante quando minimizado
  if (!isExpanded) {
    return (
      <div className={botAssistant.botFloatingButton} onClick={toggleExpand}>
        <span role="img" aria-label="bot">üéµ</span>
        <span className={botAssistant.notificationDot}></span>
      </div>
    );
  }

  return (
    <div className={botAssistant.botAssistantExpanded}>
      {/* Cabe√ßalho */}
      <div className={botAssistant.botHeader}>
        <div className={botAssistant.botInfo}>
          <div className={botAssistant.botStatus}>
            <div className={botAssistant.statusIndicatorConnected}></div>
            <span>Harmonic Group - Assistente</span>
          </div>
          <div className={botAssistant.connectionInfo}>
            ‚úÖ Online - Especialista em M√∫sica
          </div>
        </div>
        <button className={botAssistant.minimizeButton} onClick={toggleExpand}>
          <span role="img" aria-label="minimize">‚ûñ</span>
        </button>
      </div>

      {/* √Årea de Mensagens */}
      <div className={botAssistant.messagesContainer}>
        {messages.length === 0 ? (
          <div className={botAssistant.emptyState}>
            <span role="img" aria-label="bot" className={botAssistant.emptyIcon}>üéµ</span>
            <h4>Bem-vindo √† Harmonic Group!</h4>
            <p>Seu assistente musical est√° aqui para ajudar.</p>
          </div>
        ) : (
          messages.map((message) => (
            <div
              key={message.id}
              className={`${botAssistant.message} ${message.type === 'user' ? botAssistant.messageUser : botAssistant.messageBot}`}
            >
              <div className={botAssistant.messageAvatar}>
                {message.type === 'user' ? 
                  <span role="img" aria-label="user">üë§</span> : 
                  <span role="img" aria-label="bot">üéµ</span>
                }
              </div>
              <div className={botAssistant.messageContent}>
                <div className={botAssistant.messageText}>{message.text}</div>
                <div className={botAssistant.messageTime}>
                  {message.timestamp.toLocaleTimeString('pt-BR', {
                    hour: '2-digit',
                    minute: '2-digit'
                  })}
                </div>
              </div>
            </div>
          ))
        )}
        
        {isLoading && (
          <div className={`${botAssistant.message} ${botAssistant.messageBot}`}>
            <div className={botAssistant.messageAvatar}>
              <span role="img" aria-label="bot">üéµ</span>
            </div>
            <div className={botAssistant.messageContent}>
              <div className={botAssistant.typingIndicator}>
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>
        )}
        
        <div ref={messagesEndRef} />
      </div>

      {/* Sugest√µes R√°pidas */}
      <div className={botAssistant.quickSuggestions}>
        {quickQuestions.map((question, index) => (
          <button
            key={index}
            className={botAssistant.quickSuggestion}
            onClick={() => sendMessage(question)}
          >
            {question}
          </button>
        ))}
      </div>

      {/* √Årea de Input */}
      <div className={botAssistant.inputContainer}>
        <div className={botAssistant.inputWrapper}>
          <input
            type="text"
            value={inputText}
            onChange={(e) => setInputText(e.target.value)}
            onKeyPress={handleKeyPress}
            placeholder="Digite sua mensagem sobre servi√ßos musicais..."
            className={botAssistant.textInput}
          />
          {/* BOT√ÉO DE ENVIAR */}
          <button
            onClick={handleSend}
            disabled={!inputText.trim() || isLoading}
            className={botAssistant.sendButton}
          >
            <span role="img" aria-label="send">‚û§</span>
          </button>
        </div>
        
        <div className={botAssistant.suggestions}>
          <small>Tente perguntar sobre: casamentos, contrata√ß√£o, pre√ßos, estilos musicais</small>
        </div>
      </div>
    </div>
  );
};

export default BotAssistant;